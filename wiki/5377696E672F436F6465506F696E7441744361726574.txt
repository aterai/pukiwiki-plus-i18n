---
category: swing
folder: CodePointAtCaret
title: JTextAreaå†…ã«ã‚ã‚‹Caretä½ç½®ã®æ–‡å­—ã®Unicodeã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¡¨ç¤ºã™ã‚‹
tags: [Caret, JTextArea, Font]
author: aterai
pubdate: 2018-05-28T15:48:29+09:00
description: JTextAreaå†…ã«ã‚ã‚‹Caretã®éš£ã®ä½ç½®ã«ã‚ã‚‹æ–‡å­—ã®Unicodeã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’JTextFieldã«è¡¨ç¤ºã—ã¾ã™ã€‚
image: https://drive.google.com/uc?id=1t5jI8FiHF3xA21GNY307MZtNBUX5jP-O1A
---
* æ¦‚è¦ [#summary]
`JTextArea`å†…ã«ã‚ã‚‹`Caret`ã®éš£ã®ä½ç½®ã«ã‚ã‚‹æ–‡å­—ã®`Unicode`ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’`JTextField`ã«è¡¨ç¤ºã—ã¾ã™ã€‚

#download(https://drive.google.com/uc?id=1t5jI8FiHF3xA21GNY307MZtNBUX5jP-O1A)

* ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ [#sourcecode]
#code(link){{
String u1F60x = "ğŸ˜€ğŸ˜ğŸ˜‚ğŸ˜ƒğŸ˜„ğŸ˜…ğŸ˜†ğŸ˜‡ğŸ˜ˆğŸ˜‰ğŸ˜ŠğŸ˜‹ğŸ˜ŒğŸ˜ğŸ˜ğŸ˜";
String u1F61x = "ğŸ˜ğŸ˜‘ğŸ˜’ğŸ˜“ğŸ˜”ğŸ˜•ğŸ˜–ğŸ˜—ğŸ˜˜ğŸ˜™ğŸ˜šğŸ˜›ğŸ˜œğŸ˜ğŸ˜ğŸ˜Ÿ";
String u1F62x = "ğŸ˜ ğŸ˜¡ğŸ˜¢ğŸ˜£ğŸ˜¤ğŸ˜¥ğŸ˜¦ğŸ˜§ğŸ˜¨ğŸ˜©ğŸ˜ªğŸ˜«ğŸ˜¬ğŸ˜­ğŸ˜®ğŸ˜¯";
String u1F63x = "ğŸ˜°ğŸ˜±ğŸ˜²ğŸ˜³ğŸ˜´ğŸ˜µğŸ˜¶ğŸ˜·ğŸ˜¸ğŸ˜¹ğŸ˜ºğŸ˜»ğŸ˜¼ğŸ˜½ğŸ˜¾ğŸ˜¿";
String u1F64x = "ğŸ™€ğŸ™ğŸ™‚ã€€ã€€ğŸ™…ğŸ™†ğŸ™‡ğŸ™ˆğŸ™‰ğŸ™ŠğŸ™‹ğŸ™ŒğŸ™ğŸ™ğŸ™";

JTextField label = new JTextField();
label.setEditable(false);
label.setFont(label.getFont().deriveFont(32f));

List<String> l = Arrays.asList(u1F60x, u1F61x, u1F62x, u1F63x, u1F64x);
JTextArea textArea = new JTextArea(String.join("\n", l));
textArea.addCaretListener(e -> {
  try {
    int dot = e.getDot();
    int mark = e.getMark();
    if (dot - mark == 0) {
      Document doc = textArea.getDocument();
      String txt = doc.getText(dot, 1);
      int code = txt.codePointAt(0);
      if (Character.isHighSurrogate((char) code)) {
        txt = doc.getText(dot, 2);
        code = txt.codePointAt(0);
      }
      label.setText(String.format("%s: U+%04X", txt, code));
    } else {
      label.setText("");
    }
  } catch (BadLocationException ex) {
    ex.printStackTrace();
  }
});
}}

* è§£èª¬ [#explanation]
ä¸Šè¨˜ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯ã€`JTextArea`ã«`CaretListener`ã‚’è¨­å®šã—ã¦`Caret`ä½ç½®ã«ã‚ã‚‹æ–‡å­—ã‚’å–å¾—ã—ã€`String#codePointAt(...)`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãã®æ–‡å­—ã®`Unicode`ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç·¨é›†ä¸å¯ã«ã—ãŸ`JTextField`ã«è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚

- `Caret`ã®ä½ç½®ã¯ã€`CaretEvent#getDot()`ãƒ¡ã‚½ãƒƒãƒ‰ã§å–å¾—
- æ–‡å­—åˆ—é¸æŠã•ã‚Œã¦ã„ã‚‹å ´åˆ(`CaretEvent#getDot() - CaretEvent#getMark() != 0`)ã¯ãªã«ã‚‚è¡¨ç¤ºã—ãªã„
- `Caret`ã®ä½ç½®ã®æ–‡å­—ã¯ã€`JTextArea.getDocument().getText(dot, 1)`ã§å–å¾—ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒšã‚¢ã®å ´åˆã¯`String#codePointAt(...)`ã§ã‚‚`Unicode`ä¸Šä½ã‚µãƒ­ã‚²ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å˜ä½ã«ãªã‚‹
-- `Character.isHighSurrogate(char)`ãƒ¡ã‚½ãƒƒãƒ‰ã§`Unicode`ä¸Šä½ã‚µãƒ­ã‚²ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å˜ä½ã‹ã‚’èª¿æŸ»ã—ã€ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒšã‚¢ã®å ´åˆã¯`JTextArea.getDocument().getText(dot, 2)`ã§å–å¾—ã—ãŸæ–‡å­—åˆ—ã®`Unicode`ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹
- `JTextArea.getText().codePointAt(dot)`ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€æ–‡å­—åˆ—æœ«å°¾ã§`StringIndexOutOfBoundsException`ãŒç™ºç”Ÿã™ã‚‹ã®ã§æ³¨æ„ãŒå¿…è¦
- `JTextArea`ã¯ã€ã‚«ãƒ©ãƒ¼çµµæ–‡å­—ã«ã¯å¯¾å¿œã—ã¦ã„ãªã„

* å‚è€ƒãƒªãƒ³ã‚¯ [#reference]
- [https://docs.oracle.com/javase/jp/8/docs/api/java/lang/String.html#codePointAt-int- String#codePointAt(int) (Java Platform SE 8)]
- [https://docs.oracle.com/javase/jp/8/docs/api/java/lang/Character.html#isHighSurrogate-char- Character#isHighSurrogate(char) (Java Platform SE 8)]
- [[JTextComponentã§ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒšã‚¢ã®ãƒ†ã‚¹ãƒˆ>Swing/SurrogatePair]]

* ã‚³ãƒ¡ãƒ³ãƒˆ [#comment]
#comment
#comment
